<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard - Thisshop</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 min-h-screen text-slate-100">
    <div id="app" class="p-10">
        <div class="flex justify-between items-center mb-10 border-b border-slate-700 pb-6">
            <h1 class="text-3xl font-black text-orange-500">ADMIN CONTROL</h1>
            <div class="flex gap-10">
                <div class="text-center"><p class="text-xs text-slate-500">Total Sales</p><p class="text-xl font-bold text-green-400">{{ totalSales.toLocaleString() }} Ks</p></div>
                <button @click="refresh" class="bg-slate-700 px-6 py-2 rounded-full hover:bg-slate-600">Refresh</button>
            </div>
        </div>

        <div class="bg-slate-800 rounded-3xl p-6 border border-slate-700">
            <table class="w-full text-left">
                <thead>
                    <tr class="text-slate-400 text-sm uppercase">
                        <th class="p-4">Customer</th>
                        <th class="p-4">Order Items</th>
                        <th class="p-4">Total</th>
                        <th class="p-4">Status</th>
                        <th class="p-4">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="o in orders" class="border-t border-slate-700 hover:bg-slate-750 transition">
                        <td class="p-4">
                            <p class="font-bold text-sm">{{ o.userEmail }}</p>
                            <p class="text-[10px] text-slate-500">{{ o.date }}</p>
                        </td>
                        <td class="p-4">
                            <div v-for="i in o.items" class="text-xs">â€¢ {{ i.name }} (x{{ i.qty }})</div>
                        </td>
                        <td class="p-4 font-bold text-orange-400">{{ o.total.toLocaleString() }} Ks</td>
                        <td class="p-4">
                            <span :class="['px-3 py-1 rounded-full text-[10px] font-bold uppercase', sStyle(o.status)]">{{ o.status }}</span>
                        </td>
                        <td class="p-4">
                            <button v-if="o.status === 'Pending'" @click="approve(o.id)" class="bg-green-600 hover:bg-green-500 px-4 py-1.5 rounded-lg text-xs font-bold transition">Approve</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() { return { orders: JSON.parse(localStorage.getItem('globalOrders')) || [] } },
            computed: {
                totalSales() { return this.orders.filter(o => o.status === 'Success').reduce((s, o) => s + o.total, 0); }
            },
            methods: {
                refresh() { this.orders = JSON.parse(localStorage.getItem('globalOrders')) || []; },
                approve(id) {
                    this.orders = this.orders.map(o => o.id === id ? {...o, status: 'Success'} : o);
                    localStorage.setItem('globalOrders', JSON.stringify(this.orders));
                },
                sStyle(s) {
                    if(s === 'Pending') return 'bg-orange-950 text-orange-400';
                    if(s === 'Success') return 'bg-green-950 text-green-400';
                    return 'bg-red-950 text-red-400';
                }
            },
            mounted() { setInterval(this.refresh, 3000); }
        }).mount('#app');
    </script>
</body>
</html>
